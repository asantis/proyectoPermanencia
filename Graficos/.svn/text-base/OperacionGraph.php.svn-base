<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Grafico de Operaciones</title>


		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
		<style type="text/css">
${demo.css}
		</style>
		<script type="text/javascript">
$(function () {
    $('#container').highcharts({
        chart: {
            type: 'bar'
        },
        title: {
            text: 'Operaciones Realizadas'
        },
        subtitle: {
            text: ''
        },
        xAxis: {
            categories: [
<?php
$_SERVER['REQUEST_METHOD'] == 'POST';
$mysqli = new mysqli("localhost","root","","proyecto");

$exit = "";

$sql = "select tp.operacion, count(s.Tipo_Operacion) as 'Cantidad_Operacion' from salidas s
join tipo_operacion tp on tp.idOperacion=s.Tipo_Operacion
group by tp.operacion
order by Cantidad_Operacion desc";



if(isset($_POST['date'])){
$x = $mysqli ->real_escape_string($_POST['date']);	
$sql =  "select tp.operacion, count(s.Tipo_Operacion) as 'Cantidad_Operacion' from salidas s
join tipo_operacion tp on tp.idOperacion=s.Tipo_Operacion
WHERE s.fecha = '" .$x. "'
group by tp.operacion
order by Cantidad_Operacion desc"	;
}
		
$result=mysqli_query($mysqli,$sql);
while($raw=mysqli_fetch_array($result)){
			?>
			['<?php echo $raw['operacion']?>'],
			<?php 
			} 
			?>
		]
			,
            title: {
                text: null
            }
        },
        yAxis: {
            min: 0,
            title: {
                text: '',
                align: 'high'
            },
            labels: {
                overflow: 'justify'
            }
        },
        tooltip: {
            valueSuffix: ''
        },
        plotOptions: {
            bar: {
                dataLabels: {
                    enabled: true
                }
            }
        },
        legend: {
            layout: 'vertical',
            align: 'right',
            verticalAlign: 'top',
            x: -40,
            y: 100,
            floating: true,
            borderWidth: 1,
            backgroundColor: ((Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'),
            shadow: true
        },
        credits: {
            enabled: false
        },
        series: [{
            name: 'Cantidad',
            data: [
			

			
			
<?php
$mysqli = new mysqli("localhost","root","","proyecto");

$exit = "";

$sql = "select tp.operacion, count(s.Tipo_Operacion) as 'Cantidad_Operacion' from salidas s
join tipo_operacion tp on tp.idOperacion=s.Tipo_Operacion

group by tp.operacion
order by Cantidad_Operacion desc";
		
if(isset($_POST['date'])){
$x = $mysqli ->real_escape_string($_POST['date']);	
$sql = "select tp.operacion, count(s.Tipo_Operacion) as 'Cantidad_Operacion' from salidas s
join tipo_operacion tp on tp.idOperacion=s.Tipo_Operacion
WHERE s.fecha = '" .$x. "'
group by tp.operacion
order by Cantidad_Operacion desc"	;
}

$result = $mysqli->query($sql);
if ($result->num_rows > 0 ){
	
	while($row =$result->fetch_assoc()){
	?>
	<?php echo $row['Cantidad_Operacion'] ?>,<?php 
	}
}
	echo($exit);
	$mysqli->close();
?>


			]
        }]
    });
});
		</script>
	</head>
	<body>
<script src="js/jquery.min.js"></script>
<script src="js/fechas.js"></script>
<script src="../Highcharts-4.1.5/js/highcharts.js"></script>
<script src="../Highcharts-4.1.5/js/modules/exporting.js"></script>

<style>
.Formulario {
margin-left: 4%;



height: 60px;
width: 90%;	

}
</style>
</head>




<div class="Formulario">
<br />
<form method="POST" action="#"> 
<br />
<a style="font-size:20px; margin-left:3%">Seleccionar Fecha:</a>

<input style="margin-left:2%; width:200px; font-size:17px; text-align:justify" type="date" name="date" id="date"/>

<?php 

	if($_POST){
		?>
<a style="font-size:20px;margin-left:2%; "> Fecha Seleccionada:  </a><a style="font-size:20px">
<?php
	echo $_POST['date'];
	}
?> </a>

<input style="font-size:17px; width:150px; height:30px; float:right;"  type="submit" name="envio" id="envio" value="Buscar" />
<a href="OperacionGraph.php"><input style="font-size:17px; width:150px; height:30px;float:right;"; type="button" value="Reiniciar" /> </a> 
</form>

<hr />
</div>
<br /> </br>
<div id="container" style="height: 500px; max-width: 85%;  margin-left:5%; width:90% "></div>
<?php $ua = strtolower($_SERVER['HTTP_USER_AGENT']);
if(stripos($ua,'android') !== false or stripos($ua,'IPHONE') !== false){ ?>
<center><a href="../Registros/RegistroGraficos.php"> Volver Atras </a></center>
<?php }else{ ?><center><a href="../informes.php"> Volver Atras </a></center><?php } ?>
</body>
</html>